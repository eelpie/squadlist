<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<h2>My outings</h2>

<hr>
#parse('includes/nav.vm')

<form>
#foreach($outing in $outings)
	<hr>
	#parse('includes/outing.vm')	
		
	<select class="availabilityDropdown" id="${outing.id}">
		<option value="">TBA</option>		
		#foreach($option in $availabilityOptions)
			#set($selected = '')
			#if ($outing.availability == $option) 
				#set($selected = 'SELECTED')
			#end
			<option value="$option" $selected>$option</option>	
		#end
	</select>
	
	<span id="currentAvailability${outing.id}">
		#if ($outing.availability) $outing.availability #else TBA #end
	</span>
#end
</form>
<hr>

<script>
	$('.availabilityDropdown').change(function() {
    	outingId = $(this).attr('id');
    	newAvailability = $(this).val();
    	$.post("http://localhost:8080/squadlist-0.0.1-SNAPSHOT/availability/ajax", { outing: outingId, availability: newAvailability },
    	function(data) {
			$("#currentAvailability" + outingId).html(newAvailability);
		});
  	});
</script>